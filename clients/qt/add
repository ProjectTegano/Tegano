/**
* This function reads the certificate from:
* - disk - if available
* - network - if not avalable it downloads the certificate from the server and store it on disk
* Then return the certificate
**/
QSslCertificate SSLClient::handle_certificate(QString filename) {
/* read the CA certificate */
QFile file(filename);

/* if file exists */
if(!file.exists()) {
qWarning("Filename %s doesn't exists.", qPrintable(filename));
//TODO: download the file from server and store it on disk (predefined location)
}

/* open file */
if(!file.open(QIODevice::ReadOnly)) {
qWarning("Cannot open filename %s.", qPrintable(filename));
}

/* read the whole file into array */
QByteArray data = file.readAll();

/* construct new certificate */
QSslCertificate cert(data, QSsl::Pem);

/* check if the certificate is null */
if(cert.isNull()) {
qWarning("The CA certificate has no content.");
}

/* check if the certificate is valid */
if(!cert.isValid()) {
qWarning("The CA certificate expired.");
}

/* add CA certificate - to validate the peer's certificate during handshake */
//client->addCaCertificate(cert);
return cert;
}
