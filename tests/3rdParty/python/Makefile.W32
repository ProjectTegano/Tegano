TOPDIR = ..\..\..

SUBDIRS =

!INCLUDE $(TOPDIR)\makefiles\nmake\platform.mk

# C4430 happens only with ccache? why, I don't know..
INCLUDE_CXXFLAGS = \
	/D_WIN32_WINNT=0x504 /wd4430

INCLUDE_DIRS = \
	/I . /I"$(PYTHON_DIR)\include"

# Note: libraries are picked automatically on Windows!
INCLUDE_LDFLAGS =

!IFNDEF DEBUG
INCLUDE_LIBS = $(INCLUDE_LIBS) \
	"$(PYTHON_DIR)\libs\python33.lib"
!ELSE
INCLUDE_LIBS = $(INCLUDE_LIBS) \
	"$(PYTHON_DIR)\libs\python33_d.lib"
!ENDIF

TEST_CPP_BINS = \
	embed.exe

all: $(OBJS) $(CPP_BINS)

!INCLUDE $(TOPDIR)\makefiles\nmake\sub.mk

embed.exe: embed.obj

local_all:

local_clean:
	@-erase test.RES 2>NUL

local_distclean:

local_test:
!IFNDEF DEBUG
	@-copy "$(PYTHON_DIR)\libs\python33.dll" .
!ELSE
	@-copy "$(PYTHON_DIR)\libs\python33_d.dll" .
!ENDIF
	@-embed my > test.RES
